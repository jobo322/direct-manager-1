{"version":3,"file":"direct-manager.js","sources":["../src/utils/roundTo.js","../src/index.js"],"sourcesContent":["/**\n * Returns the number with the decimal places specified in the options\n * @param {number} number - The number to be rounded.\n * @param {Object} [options={}]\n * @param {number} [options.decimals] - Number of decimals.\n * @return {number}\n */\n\nexport function roundTo(number, options = {}) {\n  const { decimals = 4 } = options;\n  const power = 10 ** decimals;\n  return Math.round(number * power) / power;\n}\n","import { roundTo } from './utils/roundTo';\n\n/**\n * DIviding RECTangles manager for NMR spectra optimization\n * @param {Array} prediction - Prediction obtained with SPINUS\n */\nexport default class DirectManager {\n  constructor(prediction) {\n    this.prediction = prediction;\n    let parameters = [];\n    for (let atom of prediction) {\n      let item = {};\n      item.delta = atom.delta;\n      item.multiplicity = atom.multiplicity;\n      item.j = [];\n      for (let j of atom.j) {\n        item.j.push(j.coupling);\n      }\n      parameters.push(item);\n    }\n    this.parameters = parameters;\n  }\n\n  getParameters() {\n    return this.parameters;\n  }\n\n  suggestBoundaries(options = {}) {\n    const parameters = this.parameters;\n    const { error = 0.1 } = options;\n    let result = [];\n    for (let parameter of parameters) {\n      let atom = {};\n      atom.lowerDelta = roundTo(parameter.delta - error);\n      atom.upperDelta = roundTo(parameter.delta + error);\n      atom.lowerJcoupling = [];\n      atom.upperJcoupling = [];\n      for (let coupling of parameter.j) {\n        atom.lowerJcoupling.push(roundTo(coupling - error));\n        atom.upperJcoupling.push(roundTo(coupling + error));\n      }\n      result.push(atom);\n    }\n    return result;\n  }\n\n  getBoundaries(boundaries, options = {}) {\n    let { error = 0.1 } = options;\n    boundaries = boundaries\n      ? boundaries\n      : this.suggestBoundaries({ error: error });\n    let result = { lower: [], upper: [] };\n    for (let atom of boundaries) {\n      result.lower.push(atom.lowerDelta);\n      result.upper.push(atom.upperDelta);\n      for (let i = 0; i < atom.lowerJcoupling.length; i++) {\n        result.lower.push(atom.lowerJcoupling[i]);\n        result.upper.push(atom.upperJcoupling[i]);\n      }\n    }\n    return result;\n  }\n\n  tidyUpParameters() {\n    let result = this.prediction.slice();\n    let counter = 0;\n    return function (parameters) {\n      for (let atom of result) {\n        atom.delta = parameters[counter++];\n        for (let jcoupling of atom.j) {\n          jcoupling.coupling = parameters[counter++];\n        }\n      }\n      counter = 0;\n      return result;\n    };\n  }\n}\n"],"names":["roundTo","number","options","decimals","power","Math","round","DirectManager","constructor","prediction","parameters","atom","item","delta","multiplicity","j","push","coupling","getParameters","suggestBoundaries","error","result","parameter","lowerDelta","upperDelta","lowerJcoupling","upperJcoupling","getBoundaries","boundaries","lower","upper","i","length","tidyUpParameters","slice","counter","jcoupling"],"mappings":"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"}